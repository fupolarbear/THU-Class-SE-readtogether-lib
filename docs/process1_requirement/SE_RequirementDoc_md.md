概述
====

ReadTogether作为新一代图书馆通用信息管理系统，可在除IE以外的绝大多数平台使用，其针对图书馆的工作范围及特点，克服了传统图书馆对人力物力的巨大耗费，建立了用户子系统、图书子系统、检索统计子系统、流通信息子系统、管理子系统、社交网络子系统这几个子系统，涵盖了图书馆的主要业务工作，可以实现对图书的科学采购、规范编目、快速检索浏览、及时统计处理和完善流通等计算机管理。ReadTogether采用数据库储存图书数据、用户信息及图书流通信息，同时具备预约、权限管理、模糊搜索与推荐书目等功能。

目标
----

#### 构建ReadTogether的基本目标有：

-   使现有的图书馆资源发挥最大效用

-   减少图书馆的人力资源投入

-   简化借还书流程，增加互动设计，方便用户使用图书馆，增进读书氛围

-   提升图书馆的服务质量和服务水平

需求与限制
----------

### 要求

在管理系统运作过程中，所有书籍需要确保都放在了正确的位置。故仍需要一定的人力辅助系统的运作。

### 限制

ReadTogether对于新书输入系统需要依靠手动，故前期维护成本较高，可以通过清华大学图书馆为蓝本移植其相关图书资料。也可将图书的信息二维码化，这样只需要扫描便可自动完成管理员加入数据库或者读者进行查询的任务。

还回图书馆的书籍仍需要手动放回相应书架中，容易出现放错书架的错误。

管理员之间的管理仍然需要人工审查及干预。

管理系统组成
============

用户子系统
----------

ReadTogether设置了用户信息数据库进行管理，在注册时，用户必须填写学号，邮箱并设置密码，其中邮箱作为与用户的联系方式可以用作催还图书等用途。为每个用户组设置了一定的权限，决定了其借阅天数，可借阅图书种类。为了提醒同学们按时归还，在归还日期前两天以邮件形式告知，对于超期未归还图书者，则将其划归至黑名单中，在黑名单中的用户，只允许其进行还书与赔款等操作，禁止其继续借书与查阅行为。同时，管理员拥有临时调整权限的权利，添加新书，撤下破损书籍与通过新用户的申请等工作。

图书子系统
----------

ReadTogether中为每一本图书设置了若干状态，根据这些状态进行图书的借、还、查阅操作。状态有：整理中、暂缺、已上架（同时标注其地点）、馆内阅读、已借出（通过管理员权限可查询到借阅人员）、逾期未还、丢失已赔款、已下架。图书管理子系统允许用户在图书信息页面上报错，通过管理员审核后修改关于图书的错误信息。不同种类的图书可借阅期限不同，每本图书上还可标注过往借阅人及借阅日期。新书的上架和破损书籍的下架由管理员手动完成。对未经征定直接登记的新刊可输入刊名，ISSN，邮发代号，统一刊号，期刊类型，订购年，单价，总价，复本数，语种，责任者，编辑部，期刊条码，入馆日期，图书分类号，排架号，正题名，并列题名，副题名，第一责任者，其他责任者，译者，版本版次，开本，出版地，出版者，出版日期，页数，卷册号，价格，装订，编目时间，复本数，附录，财产登记号等，其中有些信息只作存档用不显示。而当图书下架后，存入已下架图书清单，记录下架原因及下架日期。（当图书都实现了用二维码记录其相关信息之后，也可以通过扫描二维码自动加入图书管理系统）。

检索统计子系统
--------------

ReadTogether的检索统计子系统中，设置了多种搜索方法，用户可以根据多种条件进行搜索，还可根据书籍内容的关键词，所属领域等多方面进行查找。模糊搜索功能使用户可以找到相近的书籍，并推荐最接近用户要求的查询结果，查询结果按搜索热度排序，使用户更容易找到自己需要的书籍。在统计方面，根据所有用户平时的借阅记录与搜索记录，ReadTogether在每个领域设有定期更新的推荐书目，以方便读者。

流通信息子系统
--------------

流通信息子系统是图书馆管理系统的主要功能之一，它记录了每本书的流通状况，及时在用户或管理员完成操作后改变图书的状态，建立流通信息数据库来管理书籍的流通。将用户信息添加至该书的借阅名单中，并在借阅期限到来之际通过邮件方式提醒借阅者及时归还或续借，对于逾期不还的用户不断提醒借阅者及时归还或续借。结合用户信息管理系统与图书信息管理系统，管理每本图书及用户信息。并向用户提供预约功能，用户可以从电脑web端及移动web端登陆图书管理系统页面，查找图书并预约，预约成功后在图书状态及用户状态中显示其可领取时间及排队人数，若用户没有在预约成功后的一天内前往图书馆取书则取消预约资格，恢复图书状态并降低用户权限作为惩罚。

管理子系统
----------

为了确保系统的运行正常，设置了若干管理员账号与一个root账号，其中管理员账号分为图书管理员与用户管理员。图书管理员可以对图书进行上架，下架（可恢复），修改图书有关资料的操作，维护图书数据。而用户管理员则主要针对用户权限的调整，包括临时用户的审批，将用户移出或加入黑名单，提升用户权限，删除用户数据等。而root的主要功能则是清理数据库，任命管理员。

社交网络子系统
--------------

作为用户体验的重要组成部分，社交网络方面包括了当每本书被归还时，借阅者可以为该书打分，用户也可以在书籍信息页面上对该书进行评论，管理员接受用户的举报删除一些不合理的评论，为用户的选择提供参考。鉴于豆瓣读书较有权威性，故在书籍信息页上附上豆瓣上相关搜索的网址供用户参考，在社交网络子系统中，还有许多可扩展的功能待开发。

UML设计图
---------

![ReadTogetherSys.jpg](https://git.net9.org/markasread/readtogether/raw/master/docs/ReadTogetherSys.jpg)

注：上图标明了用户与管理员分别与各子系统的关系。

逻辑需求
========

系统的注册、登入、登出功能
--------------------------

注册方式：要求申请者输入自己的真实姓名，学号，个人邮箱（以便日后还书或预约取书时发送邮件提醒），以及自己计划使用的密码，注册后由管理员核对相关信息后审批通过。

登陆方式：用户名默认为学号。

个人中心
--------

### 用户信息修改

当用户需要修改自己的资料时（如邮箱，学号与姓名不能更改），可登陆个人中心修改信息，系统会自动将信息同步至用户数据库中。

当用户需要提高自身权限时（如本科生的直硕直博），则通过向管理员提交审核来完成权限修改。

当用户离开本系统时，用户可自行删除自己的资料，每年毕业季时，系统也会将没有申请提高权限的大四同学（根据学号辨别）批量删除。

### 用户权限

学生注册后自动成为普通用户，如果能保持连续10次或以上借书按时归还，便可申请升级为高等级用户，享有更高的权限。若出现违规记录（如借书未按期归还或丢失，损坏图书等情况）则自动进入黑名单，将图书归还并缴纳罚款或赔偿后由管理员恢复普通用户权限。学校教职工注册后自动成为高等级用户，奖惩情况同学生。

### 黑名单

#### 以下行为会导致用户进入黑名单：

-   借书后未按期归还

-   图书在用户借阅期间受损

-   将图书遗失

用户在进入黑名单后权限会受到限制。在进入黑名单后用户会受到图书馆的邮件通知。在图书归还或赔偿损失后，管理员会将用户的权限等级恢复至普通用户。

### 个人中心其他服务

读书笔记：用户可以在该界面下记录自己读过的图书的有关信息和自己对于本书
读后的感想，从而使得之后的用户获得更好的阅读体验。

管理员
------

### 图书管理员

图书管理员负责对馆内藏书进行处理，同时对于错误的图书信息进行修改，并进行网络上的上架与下架操作。

### 用户管理员

用户管理员负责对于用户信息的处理和借阅行为的受理，职责包括：负责审批用户的注册和权限升级的申请，批量删除用户，将有违规操作的用户权限等级降至黑名单级别，受理黑名单用户的赔付并恢复其等级等。

### 超级管理员（Root）

职责：作为等级最高的管理员，有着任免前两类管理员的权利，并可以对数据库在更高层面进行处理。

书籍管理
--------

### 术语定义

#### 我们对于书籍和借阅行为分别设为两种不同的对象，并赋予对应的属性，具体属性如下：

A.  图书:

    -   图书状态：在架上、借出未归还（第n次被续借、超期未归还）、整理中、已下架。

    -   借书期限：参考校内图书馆部分图书不许外借，部分图书只能出借七天，部分图书可以出借14天的设置，我们规定借阅权限有0天，7天和14天三种情况。

    -   中文书名：若为中文书、中译本或影印本则直接为书名，若对于外文原本则赋空值。

    -   作者名：中英文名称皆支持。

    -   出版社：中英文名称皆支持。

    -   出版年份：代表公元纪年4位数字。

    -   版次：一个阿拉伯数字。

    -   分类：对于图书的类型定义，如文学，数学，计算机等。

    -   ISBN码：根据国际标准，每本书都有一个对应的ISBN码。

    -   原书名（非中文版图书）：中译本，影印本，外文原本的外文书名。

    -   译者（非中文版图书）：影印本和原本为空值。中译本为译者姓名。

    -   原著出版年份（非中文版图书）：代表公元纪年4位数字。

    -   原著版次（非中文版图书）：原著第X版相应的阿拉伯数字。

B.  借阅行为:

    -   借阅状态：出借中、第n次被续借、超期未归还、已归还、丢失已赔偿。

    -   借出日期：该书被借出日期，形式为年/月/日。

    -   到期日期：根据借出日期自动生成的归还截止期限，形式为年/月/日。

    -   归还日期：用户实际归还此书的日期，形式为年/月/日。

### 借还书事项

根据用户的等级，我们规定每本书用户可以借阅的时间长度为：用户的借阅期限系数\*该书的借书期限。每本书可以最多续借两次，每次可延长借书期限七天，到期后要么续借要么强制进行归还。

### 预约服务

用户可对非本人、已借出的、以及有权限书籍进行预约。用户提出预约申请后，该书将不能再被续借。该书于截止日期或之前被归还后，系统会提示预约者前来领取图书。若预约者违规未能按时拿书，则自动跳过此预约者，从预约队列里选取下一个预约者。

### 书籍信息页及用户评价功能

我们对每本书提供一个书籍信息的展示页面，提供该书有关的信息及简介等咨询，下方提供留言板，供用户对于这本书发表自己的见解，同时管理员有接受其他用户举报删除无意义或与本书无关的言论。此外，我们还设立了评分功能，供已读过此书的用户进行量化评价，得到的结果可以作为排序时的参考标准。同时，由于豆瓣读书在此方面具有一定的权威性，在每本书的信息页附有相应的豆瓣搜索结果供读者参考。

数据库
------

### 图书数据库

图书数据库中的存储信息有图书馆中所有馆藏的图书信息，包括刊名，ISSN，邮发代号，统一刊号，期刊类型，订购年，单价，总价，复本数，语种，责任者，编辑部，期刊条码，入馆日期，图书分类号，排架号，正题名，并列题名，副题名，第一责任者，其他责任者，译者，版本版次，开本，出版地，出版者，出版日期，页数，卷册号，价格，装订，编目时间，复本数，附录，财产登记号等详细信息，其中一部分不作展示用途，只作为存档功能。还记录了每本书的用户反馈，包括评论、评分、纠错记录等，并将视情况对数据库进行适当的拆分。

### 用户数据库

用户数据库中存储着所有用户的注册信息，管理员对用户的权限调整也将第一时间同步到数据库上。数据库中的用户邮箱信息便于图书的催还功能，数据库中还应导入学校的学号与姓名对应信息以方便查阅。

### 借阅行为数据库

在图书馆中每天都有庞大的借阅行为数据产生，包括用户的借书、续借、还书、预约等行为都将被记录至此，以供其他功能查阅。

查询功能
--------

本平台支持将以下信息作为查询时的依据：书名（包括原名和中文名）、作者名、出版社、出版年份、类型、ISBN码。在根据限定条件搜索出可能的所有结果后，我们以优化的排序算法，将所得结果进行展示，使得用户可以用尽可能短的时间得到想要的结果。

我们支持同时对多项属性进行限定后搜索，如：只搜索书名为《世界尽头与冷酷仙境》且译者为林少华的图书等，缩小选择范围。

此外，我们还支持模糊查询的功能，可以对输入的信息进行分析，从而得出符合用户所想的相关结果。

统计分析功能
------------

#### 我们统计以下的数据：

-   用户对于图书进行评分后将通过一定的算法计算出该书的最终得分。

-   对于用户希望得到借到的图书进行统计，在每个采购季度列出热度高的书单供图书采购员参考。

-   对于用户的良好借阅次数进行统计，方便管理员进行提升或者降低权限的操作。

-   对于每本书的借阅次数进行统计，这样可以直观地反应一本书的受欢迎程度，作为用户搜索时的一个参考依据。

邮件系统
--------

在用户注册时，我们要求用户提供自己的邮箱，以便我们发送各种通知和提醒。

我们会在以下情况下向用户发送邮件提醒：

-   所借图书到达借阅期限前3天。

-   出现违规行为导致用户被拉入黑名单时。

-   用户预约图书已归还图书馆，处于可领取状态时。

可扩展功能
----------

ReadTogether在可扩展方面提供了许多功能以完善系统，但由于种种原因在ReadTogether1.0版本中没有体现出来，但是在接下来的版本中，将逐步实现这些功能。

### 用户需求列表

当用户需要借书而由于种种原因图书馆目前并没有该书的时候，用户可以将书名添加到需求列表中，服务器将会统计所有用户的需求并按需求量进行排序，当图书馆进行新书的采购时，将会针对本季度用户需求量大的书籍进行特别采购，以满足用户需求。

### 新书推荐

作为人性化设计之一，ReadTogether推荐算法的依据是用户的借阅记录与图书的被借阅记录，自动匹配用户感兴趣的领域、话题，并在个人中心向用户推送相关书籍，从而鼓励用户阅读。除此之外，在首页上还将根据统计数据列出最受欢迎的书籍排行榜与评分最高的书籍排行榜，还有各领域的排行榜供用户参考。

### 登陆界面验证码及找回密码

为了防止使用脚本恶意登陆，在登陆界面，当尝试登录失败次数过多时，我们将调用如Google
API设置登陆验证码，并且在用户忘记密码后，由于注册时已经填写了邮箱信息，密码重设邮件将会自动发送至用户邮箱中。

### 书籍信息二维码

在书籍信息页上，相关书籍的所有信息将被编辑成二维码，可用于书目推荐与一些信息传递的功能，同时也便于下载至移动设备中随身携带。

### 电子资源管理

众所周知，清华大学图书馆中不仅仅提供了丰富的馆藏资源，还有更为丰富的电子资源，其中包括最新的各类期刊杂志，社会经济文化方面的数据库，专业检索系统、一些有声读物，甚至与其他图书馆的电子资源共享等。ReadTogether将提供一套完善的电子资源管理系统，相关资源仍采取书籍信息页的形式，属性标注为电子资源，可根据权限的不同供不同权限用户下载或在线阅读。

### 图书馆应用平台

在ReadTogether的平台上，系统中可以提供的各类数据，包括统计数据、图书数据、用户数据等，都被整理成接口，开发者们可以以API调用的形式接入该平台并随时编写所需的应用，同时在图书馆首页中单独设置一块空间作为应用的介绍与下载地址，ReadTogether的平台化也大大增强了其可扩展性。

逻辑UML图
---------

![UserSystem.jpg](https://git.net9.org/markasread/readtogether/raw/master/docs/UserSystem.jpg)

注：上图体现了图书馆的基本功能需求，其中实线箭头代表操作，虚线箭头为包含关系。

技术需求
========

图形化界面需求
--------------

ReadTogether界面简洁美观，使用户能以最快的速度找到所需的信息，采用浅色调以舒缓视觉疲劳，根据用户所使用设备调整页面布局。最佳分辨率为$1024*768$，但在其他分辨率下也可以工作。

支持平台
--------

在Google Chrome浏览器平台上能够达到最佳显示效果。

同时保证下列其他浏览器平台上的功能完整性：

-   Chrome Windows

-   Firefox Windows

-   Chrome Linux

-   Firefox Linux

-   Chrome Mobile

-   Chrome Lite Mobile

-   Safari Mobile

安全性
------

ReadTogether系统中的每一个角色都将有自己的权限，它们被分配到不同的权限组中，其中游客（未登陆）与黑名单组不能进行借书、搜索与预约操作。所有操作都以权限为依据，最高权限为Root，最低为游客与黑名单，以下为角色列表与各操作及其对应的权限。

#### 角色列表及对应权限：

A.  Root： 可进行数据库的清理，管理员权限的任命功能

B.  管理员：
    可进行图书的上、下架，修改图书资料，用户权限的调整，临时账号生成，将用户放入、移出黑名单，删除用户等功能

C.  高级用户： 可进行查阅，借还书期限延长，预约数量增加，评论功能

D.  普通用户： 可进行查阅，借还书，预约，评论功能

E.  黑名单（Blacklist）： 可进行还书，交纳罚款，查阅操作。

F.  游客（Guest）: 可进行搜索操作。

权限表：

   用户权限/用户种类   黑名单   游客   普通用户   高级用户   管理员
  ------------------- -------- ------ ---------- ---------- --------
         查询           允许    允许     允许       允许      允许
       借书数量          0       0        10         20        0
     借阅期限系数        0       0        1          2         0
     预约图书数量        0       0        1          3         0
         评论           允许    允许     允许       允许      允许
     图书资料修改       禁止    禁止     禁止       禁止      允许
     用户权限调整       禁止    禁止     禁止       禁止      允许
     生成临时账户       禁止    禁止     禁止       禁止      允许
      黑名单管理        禁止    禁止     禁止       禁止      允许
       删除账户         禁止    禁止     禁止       禁止      允许

环境需求
--------

### 开发语言

python 2.7

### 语言编码规范

PEP8

### 数据库

采用对各种平台支持较好的MySQL或者SQLite

### 服务器

Linux环境，采用Apache或者Django(release 1.5.4)

设计限制
--------

必须严格按照该需求文档进行设计。任何对本文档的疑问必须在网络学堂中提出，得到助教的确认后方可更改。

相关文档
========

设计文档
--------

暂无。

帮助文档
--------

暂无。

版本号
======

   版本号   发布时间
  -------- ----------
    1.0         
    2.0         
    3.0         

词汇表
======

-   RT : Read Together

其他
====

版权
----

MarkAsRead软工小组©

鸣谢
----

感谢老师课件对我们工作提供了帮助，感觉助教耐心又细致的指导。

感谢清华大学图书馆提供实际模型参考。